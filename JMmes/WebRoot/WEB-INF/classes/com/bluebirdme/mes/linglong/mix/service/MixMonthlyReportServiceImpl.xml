<?xml version="1.0" encoding="UTF-8"?>
<sqls>



 <sql comment="datagrid" id="datagridUDA_rows">
        <![CDATA[
            with temp as
 (select month_s,
         equip_name_s,
         master_name_s,
         materialspec_s,
         materialcode_s,
         round(oneday_train_i, 0) oneday_train_i,
         round(twoday_train_i, 0) twoday_train_i,
         round(threeday_train_i, 0) threeday_train_i,
         round(fourday_train_i, 0) fourday_train_i,
         round(fiveday_train_i, 0) fiveday_train_i,
         round(sixday_train_i, 0) sixday_train_i,
         round(sevenday_train_i, 0) sevenday_train_i,
         round(eightday_train_i, 0) eightday_train_i,
         round(nineday_train_i, 0) nineday_train_i,
         round(tenday_train_i, 0) tenday_train_i,
         round(elevenday_train_i, 0) elevenday_train_i,
         round(twelvenday_train_i, 0) twelvenday_train_i,
         round(thirteenday_train_i, 0) thirteenday_train_i,
         round(fourteenday_train_i, 0) fourteenday_train_i,
         round(fifteenday_train_i, 0) fifteenday_train_i,
         round(sixteenday_train_i, 0) sixteenday_train_i,
         round(seventeenday_train_i, 0) seventeenday_train_i,
         round(eighteenday_train_i, 0) eighteenday_train_i,
         round(ninteenday_train_i, 0) ninteenday_train_i,
         round(twentyday_train_i, 0) twentyday_train_i,
         round(twentyoneday_train_i, 0) twentyoneday_train_i,
         round(twentytwoday_train_i, 0) twentytwoday_train_i,
         round(twentythreeday_train_i, 0) twentythreeday_train_i,
         round(twentyfourday_train_i, 0) twentyfourday_train_i,
         round(twentyfiveday_train_i, 0) twentyfiveday_train_i,
         round(twentysixday_train_i, 0) twentysixday_train_i,
         round(twentysevenday_train_i, 0) twentysevenday_train_i,
         round(twentyeightday_train_i, 0) twentyeightday_train_i,
         round(twentynineday_train_i, 0) twentynineday_train_i,
         round(thirtyday_train_i, 0) thirtyday_train_i,
         round(thirtyoneday_train_i, 0) thirtyoneday_train_i,
         round(oneday_weight_d, 2) oneday_weight_d,
         round(twoday_weight_d, 2) twoday_weight_d,
         round(threeday_weight_d, 2) threeday_weight_d,
         round(fourday_weight_d, 2) fourday_weight_d,
         round(fiveday_weight_d, 2) fiveday_weight_d,
         round(sixday_weight_d, 2) sixday_weight_d,
         round(sevenday_weight_d, 2) sevenday_weight_d,
         round(eightday_weight_d, 2) eightday_weight_d,
         round(nineday_weight_d, 2) nineday_weight_d,
         round(tenday_weight_d, 2) tenday_weight_d,
         round(elevenday_weight_d, 2) elevenday_weight_d,
         round(twelvenday_weight_d, 2) twelvenday_weight_d,
         round(thirteenday_weight_d, 2) thirteenday_weight_d,
         round(fourteenday_weight_d, 2) fourteenday_weight_d,
         round(fifteenday_weight_d, 2) fifteenday_weight_d,
         round(sixteenday_weight_d, 2) sixteenday_weight_d,
         round(seventeenday_weight_d, 2) seventeenday_weight_d,
         round(eighteenday_weight_d, 2) eighteenday_weight_d,
         round(ninteenday_weight_d, 2) ninteenday_weight_d,
         round(twentyday_weight_d, 2) twentyday_weight_d,
         round(twentyoneday_weight_d, 2) twentyoneday_weight_d,
         round(twentytwoday_weight_d, 2) twentytwoday_weight_d,
         round(twentythreeday_weight_d, 2) twentythreeday_weight_d,
         round(twentyfourday_weight_d, 2) twentyfourday_weight_d,
         round(twentyfiveday_weight_d, 2) twentyfiveday_weight_d,
         round(twentysixday_weight_d, 2) twentysixday_weight_d,
         round(twentysevenday_weight_d, 2) twentysevenday_weight_d,
         round(twentyeightday_weight_d, 2) twentyeightday_weight_d,
         round(twentynineday_weight_d, 2) twentynineday_weight_d,
         round(thirtyday_weight_d, 2) thirtyday_weight_d,
         round(thirtyoneday_weight_d, 2) thirtyoneday_weight_d,
         (nvl(oneday_train_i, 0) + nvl(twoday_train_i, 0) +
         nvl(threeday_train_i, 0) + nvl(fourday_train_i, 0) +
         nvl(fiveday_train_i, 0) + nvl(sixday_train_i, 0) +
         nvl(sevenday_train_i, 0) + nvl(eightday_train_i, 0) +
         nvl(nineday_train_i, 0) + nvl(tenday_train_i, 0) +
         nvl(elevenday_train_i, 0) + nvl(twelvenday_train_i, 0) +
         nvl(thirteenday_train_i, 0) + nvl(fourteenday_train_i, 0) +
         nvl(fifteenday_train_i, 0) + nvl(sixteenday_train_i, 0) +
         nvl(seventeenday_train_i, 0) + nvl(eighteenday_train_i, 0) +
         nvl(ninteenday_train_i, 0) + nvl(twentyday_train_i, 0) +
         nvl(twentyoneday_train_i, 0) + nvl(twentytwoday_train_i, 0) +
         nvl(twentythreeday_train_i, 0) + nvl(twentyfourday_train_i, 0) +
         nvl(twentyfiveday_train_i, 0) + nvl(twentysixday_train_i, 0) +
         nvl(twentysevenday_train_i, 0) + nvl(twentyeightday_train_i, 0) +
         nvl(twentynineday_train_i, 0) + nvl(thirtyday_train_i, 0) +
         nvl(thirtyoneday_train_i, 0)) total_train_i,
         round(round(nvl(oneday_weight_d, 0), 2) +
               round(nvl(twoday_weight_d, 0), 2) +
               round(nvl(threeday_weight_d, 0), 2) +
               round(nvl(fourday_weight_d, 0), 2) +
               round(nvl(fiveday_weight_d, 0), 2) +
               round(nvl(sixday_weight_d, 0), 2) +
               round(nvl(sevenday_weight_d, 0), 2) +
               round(nvl(eightday_weight_d, 0), 2) +
               round(nvl(nineday_weight_d, 0), 2) +
               round(nvl(tenday_weight_d, 0), 2) +
               round(nvl(elevenday_weight_d, 0), 2) +
               round(nvl(twelvenday_weight_d, 0), 2) +
               round(nvl(thirteenday_weight_d, 0), 2) +
               round(nvl(fourteenday_weight_d, 0), 2) +
               round(nvl(fifteenday_weight_d, 0), 2) +
               round(nvl(sixteenday_weight_d, 0), 2) +
               round(nvl(seventeenday_weight_d, 0), 2) +
               round(nvl(eighteenday_weight_d, 0), 2) +
               round(nvl(ninteenday_weight_d, 0), 2) +
               round(nvl(twentyday_weight_d, 0), 2) +
               round(nvl(twentyoneday_weight_d, 0), 2) +
               round(nvl(twentytwoday_weight_d, 0), 2) +
               round(nvl(twentythreeday_weight_d, 0), 2) +
               round(nvl(twentyfourday_weight_d, 0), 2) +
               round(nvl(twentyfiveday_weight_d, 0), 2) +
               round(nvl(twentysixday_weight_d, 0), 2) +
               round(nvl(twentysevenday_weight_d, 0), 2) +
               round(nvl(twentyeightday_weight_d, 0), 2) +
               round(nvl(twentynineday_weight_d, 0), 2) +
               round(nvl(thirtyday_weight_d, 0), 2) +
               round(nvl(thirtyoneday_weight_d, 0), 2),
               2) total_weight_d
    from at_mx_rp_monthprod t
    where t.record_flag_s = 'A'
     and t.month_s =:month_s
     <#if spare1_s??>
          and t.spare1_s =:spare1_s
      </#if>
     <#if equip_code_s??>
          and t.equip_code_s =:equip_code_s          
      </#if>
           <#if master_name_s??>
          and t.master_name_s =:master_name_s          
      </#if>
       <#if materialcode_s??>
          and t.materialcode_s =:materialcode_s
      </#if>
       <#if materialspec_s??>
          and t.materialspec_s =:materialspec_s          
      </#if>
        <#if s_factory_s??>
          and t.s_factory_s =:s_factory_s
      </#if>
   order by equip_name_s,
            master_name_s,
            total_train_i desc,
            materialname_s,
            recipe_name_s)
select *
  from temp
union all
select N'',
       N'',
       N'',
       N'',
       N'合计：',
       ROUND(SUM(NVL(ONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TOTAL_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TOTAL_WEIGHT_D, 0)), 2)
  from temp

        ]]>
    </sql>
    <sql comment="datagrid" id="datagridUDA_total">
        <![CDATA[
            select count(1) 
            from ( with temp as
 (select month_s,
         equip_name_s,
         master_name_s,
         materialspec_s,
         materialcode_s,
         round(oneday_train_i, 0) oneday_train_i,
         round(twoday_train_i, 0) twoday_train_i,
         round(threeday_train_i, 0) threeday_train_i,
         round(fourday_train_i, 0) fourday_train_i,
         round(fiveday_train_i, 0) fiveday_train_i,
         round(sixday_train_i, 0) sixday_train_i,
         round(sevenday_train_i, 0) sevenday_train_i,
         round(eightday_train_i, 0) eightday_train_i,
         round(nineday_train_i, 0) nineday_train_i,
         round(tenday_train_i, 0) tenday_train_i,
         round(elevenday_train_i, 0) elevenday_train_i,
         round(twelvenday_train_i, 0) twelvenday_train_i,
         round(thirteenday_train_i, 0) thirteenday_train_i,
         round(fourteenday_train_i, 0) fourteenday_train_i,
         round(fifteenday_train_i, 0) fifteenday_train_i,
         round(sixteenday_train_i, 0) sixteenday_train_i,
         round(seventeenday_train_i, 0) seventeenday_train_i,
         round(eighteenday_train_i, 0) eighteenday_train_i,
         round(ninteenday_train_i, 0) ninteenday_train_i,
         round(twentyday_train_i, 0) twentyday_train_i,
         round(twentyoneday_train_i, 0) twentyoneday_train_i,
         round(twentytwoday_train_i, 0) twentytwoday_train_i,
         round(twentythreeday_train_i, 0) twentythreeday_train_i,
         round(twentyfourday_train_i, 0) twentyfourday_train_i,
         round(twentyfiveday_train_i, 0) twentyfiveday_train_i,
         round(twentysixday_train_i, 0) twentysixday_train_i,
         round(twentysevenday_train_i, 0) twentysevenday_train_i,
         round(twentyeightday_train_i, 0) twentyeightday_train_i,
         round(twentynineday_train_i, 0) twentynineday_train_i,
         round(thirtyday_train_i, 0) thirtyday_train_i,
         round(thirtyoneday_train_i, 0) thirtyoneday_train_i,
         round(oneday_weight_d, 2) oneday_weight_d,
         round(twoday_weight_d, 2) twoday_weight_d,
         round(threeday_weight_d, 2) threeday_weight_d,
         round(fourday_weight_d, 2) fourday_weight_d,
         round(fiveday_weight_d, 2) fiveday_weight_d,
         round(sixday_weight_d, 2) sixday_weight_d,
         round(sevenday_weight_d, 2) sevenday_weight_d,
         round(eightday_weight_d, 2) eightday_weight_d,
         round(nineday_weight_d, 2) nineday_weight_d,
         round(tenday_weight_d, 2) tenday_weight_d,
         round(elevenday_weight_d, 2) elevenday_weight_d,
         round(twelvenday_weight_d, 2) twelvenday_weight_d,
         round(thirteenday_weight_d, 2) thirteenday_weight_d,
         round(fourteenday_weight_d, 2) fourteenday_weight_d,
         round(fifteenday_weight_d, 2) fifteenday_weight_d,
         round(sixteenday_weight_d, 2) sixteenday_weight_d,
         round(seventeenday_weight_d, 2) seventeenday_weight_d,
         round(eighteenday_weight_d, 2) eighteenday_weight_d,
         round(ninteenday_weight_d, 2) ninteenday_weight_d,
         round(twentyday_weight_d, 2) twentyday_weight_d,
         round(twentyoneday_weight_d, 2) twentyoneday_weight_d,
         round(twentytwoday_weight_d, 2) twentytwoday_weight_d,
         round(twentythreeday_weight_d, 2) twentythreeday_weight_d,
         round(twentyfourday_weight_d, 2) twentyfourday_weight_d,
         round(twentyfiveday_weight_d, 2) twentyfiveday_weight_d,
         round(twentysixday_weight_d, 2) twentysixday_weight_d,
         round(twentysevenday_weight_d, 2) twentysevenday_weight_d,
         round(twentyeightday_weight_d, 2) twentyeightday_weight_d,
         round(twentynineday_weight_d, 2) twentynineday_weight_d,
         round(thirtyday_weight_d, 2) thirtyday_weight_d,
         round(thirtyoneday_weight_d, 2) thirtyoneday_weight_d,
         (nvl(oneday_train_i, 0) + nvl(twoday_train_i, 0) +
         nvl(threeday_train_i, 0) + nvl(fourday_train_i, 0) +
         nvl(fiveday_train_i, 0) + nvl(sixday_train_i, 0) +
         nvl(sevenday_train_i, 0) + nvl(eightday_train_i, 0) +
         nvl(nineday_train_i, 0) + nvl(tenday_train_i, 0) +
         nvl(elevenday_train_i, 0) + nvl(twelvenday_train_i, 0) +
         nvl(thirteenday_train_i, 0) + nvl(fourteenday_train_i, 0) +
         nvl(fifteenday_train_i, 0) + nvl(sixteenday_train_i, 0) +
         nvl(seventeenday_train_i, 0) + nvl(eighteenday_train_i, 0) +
         nvl(ninteenday_train_i, 0) + nvl(twentyday_train_i, 0) +
         nvl(twentyoneday_train_i, 0) + nvl(twentytwoday_train_i, 0) +
         nvl(twentythreeday_train_i, 0) + nvl(twentyfourday_train_i, 0) +
         nvl(twentyfiveday_train_i, 0) + nvl(twentysixday_train_i, 0) +
         nvl(twentysevenday_train_i, 0) + nvl(twentyeightday_train_i, 0) +
         nvl(twentynineday_train_i, 0) + nvl(thirtyday_train_i, 0) +
         nvl(thirtyoneday_train_i, 0)) total_train_i,
         round(round(nvl(oneday_weight_d, 0), 2) +
               round(nvl(twoday_weight_d, 0), 2) +
               round(nvl(threeday_weight_d, 0), 2) +
               round(nvl(fourday_weight_d, 0), 2) +
               round(nvl(fiveday_weight_d, 0), 2) +
               round(nvl(sixday_weight_d, 0), 2) +
               round(nvl(sevenday_weight_d, 0), 2) +
               round(nvl(eightday_weight_d, 0), 2) +
               round(nvl(nineday_weight_d, 0), 2) +
               round(nvl(tenday_weight_d, 0), 2) +
               round(nvl(elevenday_weight_d, 0), 2) +
               round(nvl(twelvenday_weight_d, 0), 2) +
               round(nvl(thirteenday_weight_d, 0), 2) +
               round(nvl(fourteenday_weight_d, 0), 2) +
               round(nvl(fifteenday_weight_d, 0), 2) +
               round(nvl(sixteenday_weight_d, 0), 2) +
               round(nvl(seventeenday_weight_d, 0), 2) +
               round(nvl(eighteenday_weight_d, 0), 2) +
               round(nvl(ninteenday_weight_d, 0), 2) +
               round(nvl(twentyday_weight_d, 0), 2) +
               round(nvl(twentyoneday_weight_d, 0), 2) +
               round(nvl(twentytwoday_weight_d, 0), 2) +
               round(nvl(twentythreeday_weight_d, 0), 2) +
               round(nvl(twentyfourday_weight_d, 0), 2) +
               round(nvl(twentyfiveday_weight_d, 0), 2) +
               round(nvl(twentysixday_weight_d, 0), 2) +
               round(nvl(twentysevenday_weight_d, 0), 2) +
               round(nvl(twentyeightday_weight_d, 0), 2) +
               round(nvl(twentynineday_weight_d, 0), 2) +
               round(nvl(thirtyday_weight_d, 0), 2) +
               round(nvl(thirtyoneday_weight_d, 0), 2),
               2) total_weight_d
    from at_mx_rp_monthprod t
    where t.record_flag_s = 'A'
     and t.month_s =:month_s
     <#if spare1_s??>
          and t.spare1_s =:spare1_s
      </#if>
       <#if equip_code_s??>
          and t.equip_code_s =:equip_code_s          
      </#if>
      <#if master_name_s??>
          and t.master_name_s =:master_name_s          
      </#if>
       <#if materialcode_s??>
          and t.materialcode_s =:materialcode_s
      </#if>
      <#if materialspec_s??>
          and t.materialspec_s =:materialspec_s          
      </#if>
      <#if s_factory_s??>
          and t.s_factory_s =:s_factory_s
      </#if>
   order by equip_name_s,
            master_name_s,
            total_train_i desc,
            materialname_s,
            recipe_name_s)
select *
  from temp
union all
select N'',
       N'',
       N'',
       N'',
       N'合计：',
       ROUND(SUM(NVL(ONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TOTAL_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TOTAL_WEIGHT_D, 0)), 2)
  from temp
                     )a
                    
        ]]>
    </sql>

<sql comment="datagrid" id="datagrid_rows">
        <![CDATA[
            with temp as
 (select month_s,
         equip_name_s,
         master_name_s,
         materialspec_s,
         materialcode_s,
         round(oneday_train_i, 0) oneday_train_i,
         round(twoday_train_i, 0) twoday_train_i,
         round(threeday_train_i, 0) threeday_train_i,
         round(fourday_train_i, 0) fourday_train_i,
         round(fiveday_train_i, 0) fiveday_train_i,
         round(sixday_train_i, 0) sixday_train_i,
         round(sevenday_train_i, 0) sevenday_train_i,
         round(eightday_train_i, 0) eightday_train_i,
         round(nineday_train_i, 0) nineday_train_i,
         round(tenday_train_i, 0) tenday_train_i,
         round(elevenday_train_i, 0) elevenday_train_i,
         round(twelvenday_train_i, 0) twelvenday_train_i,
         round(thirteenday_train_i, 0) thirteenday_train_i,
         round(fourteenday_train_i, 0) fourteenday_train_i,
         round(fifteenday_train_i, 0) fifteenday_train_i,
         round(sixteenday_train_i, 0) sixteenday_train_i,
         round(seventeenday_train_i, 0) seventeenday_train_i,
         round(eighteenday_train_i, 0) eighteenday_train_i,
         round(ninteenday_train_i, 0) ninteenday_train_i,
         round(twentyday_train_i, 0) twentyday_train_i,
         round(twentyoneday_train_i, 0) twentyoneday_train_i,
         round(twentytwoday_train_i, 0) twentytwoday_train_i,
         round(twentythreeday_train_i, 0) twentythreeday_train_i,
         round(twentyfourday_train_i, 0) twentyfourday_train_i,
         round(twentyfiveday_train_i, 0) twentyfiveday_train_i,
         round(twentysixday_train_i, 0) twentysixday_train_i,
         round(twentysevenday_train_i, 0) twentysevenday_train_i,
         round(twentyeightday_train_i, 0) twentyeightday_train_i,
         round(twentynineday_train_i, 0) twentynineday_train_i,
         round(thirtyday_train_i, 0) thirtyday_train_i,
         round(thirtyoneday_train_i, 0) thirtyoneday_train_i,
         round(oneday_weight_d, 2) oneday_weight_d,
         round(twoday_weight_d, 2) twoday_weight_d,
         round(threeday_weight_d, 2) threeday_weight_d,
         round(fourday_weight_d, 2) fourday_weight_d,
         round(fiveday_weight_d, 2) fiveday_weight_d,
         round(sixday_weight_d, 2) sixday_weight_d,
         round(sevenday_weight_d, 2) sevenday_weight_d,
         round(eightday_weight_d, 2) eightday_weight_d,
         round(nineday_weight_d, 2) nineday_weight_d,
         round(tenday_weight_d, 2) tenday_weight_d,
         round(elevenday_weight_d, 2) elevenday_weight_d,
         round(twelvenday_weight_d, 2) twelvenday_weight_d,
         round(thirteenday_weight_d, 2) thirteenday_weight_d,
         round(fourteenday_weight_d, 2) fourteenday_weight_d,
         round(fifteenday_weight_d, 2) fifteenday_weight_d,
         round(sixteenday_weight_d, 2) sixteenday_weight_d,
         round(seventeenday_weight_d, 2) seventeenday_weight_d,
         round(eighteenday_weight_d, 2) eighteenday_weight_d,
         round(ninteenday_weight_d, 2) ninteenday_weight_d,
         round(twentyday_weight_d, 2) twentyday_weight_d,
         round(twentyoneday_weight_d, 2) twentyoneday_weight_d,
         round(twentytwoday_weight_d, 2) twentytwoday_weight_d,
         round(twentythreeday_weight_d, 2) twentythreeday_weight_d,
         round(twentyfourday_weight_d, 2) twentyfourday_weight_d,
         round(twentyfiveday_weight_d, 2) twentyfiveday_weight_d,
         round(twentysixday_weight_d, 2) twentysixday_weight_d,
         round(twentysevenday_weight_d, 2) twentysevenday_weight_d,
         round(twentyeightday_weight_d, 2) twentyeightday_weight_d,
         round(twentynineday_weight_d, 2) twentynineday_weight_d,
         round(thirtyday_weight_d, 2) thirtyday_weight_d,
         round(thirtyoneday_weight_d, 2) thirtyoneday_weight_d,
         (nvl(oneday_train_i, 0) + nvl(twoday_train_i, 0) +
         nvl(threeday_train_i, 0) + nvl(fourday_train_i, 0) +
         nvl(fiveday_train_i, 0) + nvl(sixday_train_i, 0) +
         nvl(sevenday_train_i, 0) + nvl(eightday_train_i, 0) +
         nvl(nineday_train_i, 0) + nvl(tenday_train_i, 0) +
         nvl(elevenday_train_i, 0) + nvl(twelvenday_train_i, 0) +
         nvl(thirteenday_train_i, 0) + nvl(fourteenday_train_i, 0) +
         nvl(fifteenday_train_i, 0) + nvl(sixteenday_train_i, 0) +
         nvl(seventeenday_train_i, 0) + nvl(eighteenday_train_i, 0) +
         nvl(ninteenday_train_i, 0) + nvl(twentyday_train_i, 0) +
         nvl(twentyoneday_train_i, 0) + nvl(twentytwoday_train_i, 0) +
         nvl(twentythreeday_train_i, 0) + nvl(twentyfourday_train_i, 0) +
         nvl(twentyfiveday_train_i, 0) + nvl(twentysixday_train_i, 0) +
         nvl(twentysevenday_train_i, 0) + nvl(twentyeightday_train_i, 0) +
         nvl(twentynineday_train_i, 0) + nvl(thirtyday_train_i, 0) +
         nvl(thirtyoneday_train_i, 0)) total_train_i,
         round(round(nvl(oneday_weight_d, 0), 2) +
               round(nvl(twoday_weight_d, 0), 2) +
               round(nvl(threeday_weight_d, 0), 2) +
               round(nvl(fourday_weight_d, 0), 2) +
               round(nvl(fiveday_weight_d, 0), 2) +
               round(nvl(sixday_weight_d, 0), 2) +
               round(nvl(sevenday_weight_d, 0), 2) +
               round(nvl(eightday_weight_d, 0), 2) +
               round(nvl(nineday_weight_d, 0), 2) +
               round(nvl(tenday_weight_d, 0), 2) +
               round(nvl(elevenday_weight_d, 0), 2) +
               round(nvl(twelvenday_weight_d, 0), 2) +
               round(nvl(thirteenday_weight_d, 0), 2) +
               round(nvl(fourteenday_weight_d, 0), 2) +
               round(nvl(fifteenday_weight_d, 0), 2) +
               round(nvl(sixteenday_weight_d, 0), 2) +
               round(nvl(seventeenday_weight_d, 0), 2) +
               round(nvl(eighteenday_weight_d, 0), 2) +
               round(nvl(ninteenday_weight_d, 0), 2) +
               round(nvl(twentyday_weight_d, 0), 2) +
               round(nvl(twentyoneday_weight_d, 0), 2) +
               round(nvl(twentytwoday_weight_d, 0), 2) +
               round(nvl(twentythreeday_weight_d, 0), 2) +
               round(nvl(twentyfourday_weight_d, 0), 2) +
               round(nvl(twentyfiveday_weight_d, 0), 2) +
               round(nvl(twentysixday_weight_d, 0), 2) +
               round(nvl(twentysevenday_weight_d, 0), 2) +
               round(nvl(twentyeightday_weight_d, 0), 2) +
               round(nvl(twentynineday_weight_d, 0), 2) +
               round(nvl(thirtyday_weight_d, 0), 2) +
               round(nvl(thirtyoneday_weight_d, 0), 2),
               2) total_weight_d
    from at_mx_rp_monthprod t
    where t.record_flag_s = 'A'
     and t.month_s =:month_s
     <#if spare1_s??>
          and t.spare1_s =:spare1_s
      </#if>
     <#if equip_code_s??>
          and t.equip_code_s =:equip_code_s          
      </#if>
           <#if master_name_s??>
          and t.master_name_s =:master_name_s          
      </#if>
       <#if materialcode_s??>
          and t.materialcode_s =:materialcode_s
      </#if>
       <#if materialspec_s??>
          and t.materialspec_s =:materialspec_s          
      </#if>
        <#if s_factory_s??>
          and t.s_factory_s =:s_factory_s
      </#if>
   order by equip_name_s,
            master_name_s,
            total_train_i desc,
            materialname_s,
            recipe_name_s)
select *
  from temp
union all
select N'',
       N'',
       N'',
       N'',
       N'合计：',
       ROUND(SUM(NVL(ONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TOTAL_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TOTAL_WEIGHT_D, 0)), 2)
  from temp

        ]]>
    </sql>
    <sql comment="datagrid" id="datagrid_total">
        <![CDATA[
            select count(1) 
            from ( with temp as
 (select month_s,
         equip_name_s,
         master_name_s,
         materialspec_s,
         materialcode_s,
         round(oneday_train_i, 0) oneday_train_i,
         round(twoday_train_i, 0) twoday_train_i,
         round(threeday_train_i, 0) threeday_train_i,
         round(fourday_train_i, 0) fourday_train_i,
         round(fiveday_train_i, 0) fiveday_train_i,
         round(sixday_train_i, 0) sixday_train_i,
         round(sevenday_train_i, 0) sevenday_train_i,
         round(eightday_train_i, 0) eightday_train_i,
         round(nineday_train_i, 0) nineday_train_i,
         round(tenday_train_i, 0) tenday_train_i,
         round(elevenday_train_i, 0) elevenday_train_i,
         round(twelvenday_train_i, 0) twelvenday_train_i,
         round(thirteenday_train_i, 0) thirteenday_train_i,
         round(fourteenday_train_i, 0) fourteenday_train_i,
         round(fifteenday_train_i, 0) fifteenday_train_i,
         round(sixteenday_train_i, 0) sixteenday_train_i,
         round(seventeenday_train_i, 0) seventeenday_train_i,
         round(eighteenday_train_i, 0) eighteenday_train_i,
         round(ninteenday_train_i, 0) ninteenday_train_i,
         round(twentyday_train_i, 0) twentyday_train_i,
         round(twentyoneday_train_i, 0) twentyoneday_train_i,
         round(twentytwoday_train_i, 0) twentytwoday_train_i,
         round(twentythreeday_train_i, 0) twentythreeday_train_i,
         round(twentyfourday_train_i, 0) twentyfourday_train_i,
         round(twentyfiveday_train_i, 0) twentyfiveday_train_i,
         round(twentysixday_train_i, 0) twentysixday_train_i,
         round(twentysevenday_train_i, 0) twentysevenday_train_i,
         round(twentyeightday_train_i, 0) twentyeightday_train_i,
         round(twentynineday_train_i, 0) twentynineday_train_i,
         round(thirtyday_train_i, 0) thirtyday_train_i,
         round(thirtyoneday_train_i, 0) thirtyoneday_train_i,
         round(oneday_weight_d, 2) oneday_weight_d,
         round(twoday_weight_d, 2) twoday_weight_d,
         round(threeday_weight_d, 2) threeday_weight_d,
         round(fourday_weight_d, 2) fourday_weight_d,
         round(fiveday_weight_d, 2) fiveday_weight_d,
         round(sixday_weight_d, 2) sixday_weight_d,
         round(sevenday_weight_d, 2) sevenday_weight_d,
         round(eightday_weight_d, 2) eightday_weight_d,
         round(nineday_weight_d, 2) nineday_weight_d,
         round(tenday_weight_d, 2) tenday_weight_d,
         round(elevenday_weight_d, 2) elevenday_weight_d,
         round(twelvenday_weight_d, 2) twelvenday_weight_d,
         round(thirteenday_weight_d, 2) thirteenday_weight_d,
         round(fourteenday_weight_d, 2) fourteenday_weight_d,
         round(fifteenday_weight_d, 2) fifteenday_weight_d,
         round(sixteenday_weight_d, 2) sixteenday_weight_d,
         round(seventeenday_weight_d, 2) seventeenday_weight_d,
         round(eighteenday_weight_d, 2) eighteenday_weight_d,
         round(ninteenday_weight_d, 2) ninteenday_weight_d,
         round(twentyday_weight_d, 2) twentyday_weight_d,
         round(twentyoneday_weight_d, 2) twentyoneday_weight_d,
         round(twentytwoday_weight_d, 2) twentytwoday_weight_d,
         round(twentythreeday_weight_d, 2) twentythreeday_weight_d,
         round(twentyfourday_weight_d, 2) twentyfourday_weight_d,
         round(twentyfiveday_weight_d, 2) twentyfiveday_weight_d,
         round(twentysixday_weight_d, 2) twentysixday_weight_d,
         round(twentysevenday_weight_d, 2) twentysevenday_weight_d,
         round(twentyeightday_weight_d, 2) twentyeightday_weight_d,
         round(twentynineday_weight_d, 2) twentynineday_weight_d,
         round(thirtyday_weight_d, 2) thirtyday_weight_d,
         round(thirtyoneday_weight_d, 2) thirtyoneday_weight_d,
         (nvl(oneday_train_i, 0) + nvl(twoday_train_i, 0) +
         nvl(threeday_train_i, 0) + nvl(fourday_train_i, 0) +
         nvl(fiveday_train_i, 0) + nvl(sixday_train_i, 0) +
         nvl(sevenday_train_i, 0) + nvl(eightday_train_i, 0) +
         nvl(nineday_train_i, 0) + nvl(tenday_train_i, 0) +
         nvl(elevenday_train_i, 0) + nvl(twelvenday_train_i, 0) +
         nvl(thirteenday_train_i, 0) + nvl(fourteenday_train_i, 0) +
         nvl(fifteenday_train_i, 0) + nvl(sixteenday_train_i, 0) +
         nvl(seventeenday_train_i, 0) + nvl(eighteenday_train_i, 0) +
         nvl(ninteenday_train_i, 0) + nvl(twentyday_train_i, 0) +
         nvl(twentyoneday_train_i, 0) + nvl(twentytwoday_train_i, 0) +
         nvl(twentythreeday_train_i, 0) + nvl(twentyfourday_train_i, 0) +
         nvl(twentyfiveday_train_i, 0) + nvl(twentysixday_train_i, 0) +
         nvl(twentysevenday_train_i, 0) + nvl(twentyeightday_train_i, 0) +
         nvl(twentynineday_train_i, 0) + nvl(thirtyday_train_i, 0) +
         nvl(thirtyoneday_train_i, 0)) total_train_i,
         round(round(nvl(oneday_weight_d, 0), 2) +
               round(nvl(twoday_weight_d, 0), 2) +
               round(nvl(threeday_weight_d, 0), 2) +
               round(nvl(fourday_weight_d, 0), 2) +
               round(nvl(fiveday_weight_d, 0), 2) +
               round(nvl(sixday_weight_d, 0), 2) +
               round(nvl(sevenday_weight_d, 0), 2) +
               round(nvl(eightday_weight_d, 0), 2) +
               round(nvl(nineday_weight_d, 0), 2) +
               round(nvl(tenday_weight_d, 0), 2) +
               round(nvl(elevenday_weight_d, 0), 2) +
               round(nvl(twelvenday_weight_d, 0), 2) +
               round(nvl(thirteenday_weight_d, 0), 2) +
               round(nvl(fourteenday_weight_d, 0), 2) +
               round(nvl(fifteenday_weight_d, 0), 2) +
               round(nvl(sixteenday_weight_d, 0), 2) +
               round(nvl(seventeenday_weight_d, 0), 2) +
               round(nvl(eighteenday_weight_d, 0), 2) +
               round(nvl(ninteenday_weight_d, 0), 2) +
               round(nvl(twentyday_weight_d, 0), 2) +
               round(nvl(twentyoneday_weight_d, 0), 2) +
               round(nvl(twentytwoday_weight_d, 0), 2) +
               round(nvl(twentythreeday_weight_d, 0), 2) +
               round(nvl(twentyfourday_weight_d, 0), 2) +
               round(nvl(twentyfiveday_weight_d, 0), 2) +
               round(nvl(twentysixday_weight_d, 0), 2) +
               round(nvl(twentysevenday_weight_d, 0), 2) +
               round(nvl(twentyeightday_weight_d, 0), 2) +
               round(nvl(twentynineday_weight_d, 0), 2) +
               round(nvl(thirtyday_weight_d, 0), 2) +
               round(nvl(thirtyoneday_weight_d, 0), 2),
               2) total_weight_d
    from at_mx_rp_monthprod t
    where t.record_flag_s = 'A'
     and t.month_s =:month_s
     <#if spare1_s??>
          and t.spare1_s =:spare1_s
      </#if>
       <#if equip_code_s??>
          and t.equip_code_s =:equip_code_s          
      </#if>
      <#if master_name_s??>
          and t.master_name_s =:master_name_s          
      </#if>
       <#if materialcode_s??>
          and t.materialcode_s =:materialcode_s
      </#if>
      <#if materialspec_s??>
          and t.materialspec_s =:materialspec_s          
      </#if>
      <#if s_factory_s??>
          and t.s_factory_s =:s_factory_s
      </#if>
   order by equip_name_s,
            master_name_s,
            total_train_i desc,
            materialname_s,
            recipe_name_s)
select *
  from temp
union all
select N'',
       N'',
       N'',
       N'',
       N'合计：',
       ROUND(SUM(NVL(ONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(ONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(ELEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWELVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FOURTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(FIFTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SIXTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(SEVENTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(EIGHTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(NINTEENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTWODAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYTHREEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFOURDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYFIVEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSIXDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYSEVENDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYEIGHTDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TWENTYNINEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(THIRTYONEDAY_WEIGHT_D, 0)), 2),
       ROUND(SUM(NVL(TOTAL_TRAIN_I, 0)), 2),
       ROUND(SUM(NVL(TOTAL_WEIGHT_D, 0)), 2)
  from temp
                     )a
                    
        ]]>
    </sql>
	<sql comment="getmasternamelist" id="getmasternamelist">
        <![CDATA[

                
     select  distinct master_name_s
       from at_mx_rp_monthprod t
       where t.record_flag_s = 'A'
        and t.s_factory_s = '2'
        and t.spare1_s='1'
        and t.month_s =:month_s
                
        ]]>
    </sql>
    <sql comment="getmaterialspeclist" id="getmaterialspeclist">
        <![CDATA[

              select  distinct materialspec_s
                from at_mx_rp_monthprod t
               where t.record_flag_s = 'A'
                 and t.s_factory_s = '2'
                 and t.spare1_s=:spare1_s
                 and t.month_s =:month_s

        ]]>
    </sql>
</sqls>